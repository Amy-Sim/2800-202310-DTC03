<%- include("templates/header") %>
<div class="container">
  <% if (!session.GLOBAL_AUTHENTICATED) { %>
    <div class="alert alert-danger">
      Access denied. You must be logged in to view this page.
      <a href="/login">Go to login</a>
    </div>
  <% } else { %>
    <main class="form-signiin w-100 m-auto">
      <div class="d-flex gap-2 justify-content-center py-5">
        <form class="text-left" action="/profile_change_password" method="post" style="min-width: 380px;">
          <h1 class="h3 mb-4 fw-normal text-center">Change password</h1>
          <% if (locals.errors) { %>
            <div class="alert alert-danger">
              <% for (let i = 0; i < locals.errors.length; i++) { %>
                <p><%= locals.errors[i].message %></p>
              <% } %>
            </div>
          <% } %>
          <div class="form-group mb-2">
            <div class="form-floating">
              <input type="password" name="password" class="form-control" id="floatingUsername" value="">
              <label for="new_password">New password</label>
            </div>
            <div class="form-floating">
            <input type="password" name="confirmPassword" class="form-control" id="floatingUsername" value="">
            <label for="confirm_new_password">Confirm password</label>
            </div>
          <button id="edit" class="w-100 btn btn-lg btn-warning mt-3" type="submit">Submit</button>
          <button type="button" class="mt-3 w-100 btn btn-lg btn-outline-warning" onclick="location.href='/profile';">Cancel</button>
        </form>
      </div>
    </main>
  <% } %>
</div>
<%- include("templates/footer") %>
<script>
  function toggleFields() {
    // if edit's innerhtml is edit, change it to cancel and enable all fields except username
    // else, change it to edit and disable all fields except username
    if (document.getElementById("edit").innerHTML == "Edit") {
      document.getElementById("edit").innerHTML = "Cancel";
      document.getElementById("floatingName").disabled = false;
      document.getElementById("floatingEmail").disabled = false;
    } else {
      document.getElementById("edit").innerHTML = "Edit";
      document.getElementById("floatingName").disabled = true;
      document.getElementById("floatingEmail").disabled = true;
    }
  }
</script>
